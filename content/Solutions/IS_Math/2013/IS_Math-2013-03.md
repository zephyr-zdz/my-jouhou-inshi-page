# IS_Math-2013-03

**题目来源**：[[做题/文字版题库/IS_Math/2013#Problem 3]]
**日期**：2024-08-09
**题目主题**: CS-概率论-古典概率

## 解题思路

题目涉及重复操作中颜色球的数量变化，考察概率计算。题目涉及对球的颜色变化的统计，需用到组合计数和递推公式来求解。考虑逐步增加颜色的可能性并结合递推关系式给出相应概率。

## Solution

### Question 1

Consider the case where **Operation A** is repeated 3 times. Find the probability that the number of colors of the balls in the bag (black is not counted) is 2 and 3, respectively.

1. **Initial State**: The bag contains 1 black ball (B).

2. **After 1st operation**:
   - The black ball (B) is drawn, and a new ball of color 1 (say R for red) is added.
   - **Bag Content**: {B, R}
   - **Number of colors (not counting black)**: 1

   **Illustration**:
   ```
   [ B ] -> Draw B -> [ B, R ]
   ```

3. **After 2nd operation**:
   - There are two possibilities:
     - Draw R (Red): return R with another R. **Bag Content**: {B, R, R}
     - Draw B (Black): add a new color, say G (Green). **Bag Content**: {B, R, G}
   - **Probabilities**:
     - Probability of drawing R: $\frac{1}{2}$, results in 1 color.
     - Probability of drawing B: $\frac{1}{2}$, results in 2 colors.

   **Illustration**:
   ```
   [ B, R ] -> Draw R -> [ B, R, R ]  (1 color remains) 1/2
   [ B, R ] -> Draw B -> [ B, R, G ]  (2 colors now) 1/2
   ```

4. **After 3rd operation**:
   - If **Bag Content** = {B, R, R}, draw results:
     - Draw R: return R with another R. **Bag Content**: {B, R, R, R}
     - Draw B: add a new color, say G. **Bag Content**: {B, R, R, G}
   - If **Bag Content** = {B, R, G}, draw results:
     - Draw R or G: return with same color, stay with 2 colors.
     - Draw B: add a new color, say Y (Yellow). **Bag Content**: {B, R, G, Y}
   - **Probabilities**:
     - From 2 colors (after 2 operations):
       - Probability for 3 colors: $\frac{1}{2} \times \frac{1}{3} = \frac{1}{6}$
       - Probability for 2 colors: $\frac{1}{2} \times \frac{1}{3} + \frac{1}{2} \times \frac{2}{3} = \frac{1}{2}$
     - From 1 color (after 2 operations):
       - Probability remains 1 color: $\frac{1}{2} \times \frac{2}{3} = \frac{1}{3}$.

   **Illustration**:
   ```
   [ B, R, R ] -> Draw R -> [ B, R, R, R ] (1 color) 1/3
   [ B, R, R ] -> Draw B -> [ B, R, R, G ] (2 colors) 1/6
   
   [ B, R, G ] -> Draw R/G -> [ B, R, G, R/G ] (2 colors) 1/3
   [ B, R, G ] -> Draw B -> [ B, R, G, Y ] (3 colors) 1/6
   ```

**Final result**:
- The probability that the number of non-black colors is 2 is $\frac{1}{2}$
- The probability that it is 3 is $\frac{1}{6}$.

### Question 2

Consider the case where **Operation A** is repeated 4 times. Find the probability that the number of colors of the balls in the bag (black is not counted) is 3.

#### Step 1: Analyze the outcome after 4 operations

**Bag Content after 3 operations**:
- It could be {B, R, G, R/G} (2 colors) or {B, R, G, Y} (3 colors).

#### Step 2: Probability computation for 4 operations

- If there are 2 colors after 3 operations:
  - Drawing B in the 4th operation adds a new color, achieving 3 colors.
- If there are already 3 colors after 3 operations:
  - Any non-colored ball drawn keeps it at 3 colors.

**Calculation**:
- After 3 operations, probability of having 2 colors: $\frac{1}{2}$.
- Probability of adding a 3rd color in the 4th operation: $\frac{1}{2} \times \frac{1}{4} = \frac{1}{8}$.
- Probability of staying with 3 colors if already 3 colors: $\frac{1}{6} \times \frac{3}{4} = \frac{1}{8}$.

Final probability for 3 colors after 4 operations is $\frac{1}{8} + \frac{1}{8} = \frac{1}{4}$.

### Question 3

To prove this by induction, we will proceed as follows:

#### Base Case

When $n = 1$:

- Initially, there is only one black ball in the bag.
- After the first operation, we draw the black ball, and a new color (say color 1) is added to the bag.
- At this point, the bag contains two balls: one black ball and one non-black ball (color 1).
- The probability that there is only one non-black color in the bag is 1.

So, the base case is true: $\frac{1}{1} = 1$.

#### Inductive Hypothesis

Assume that after $k$ operations, the probability that there is exactly 1 non-black color in the bag is $\frac{1}{k}$.

#### Inductive Step

We now need to show that if the hypothesis holds for $n = k$, then it also holds for $n = k+1$.

After $k$ operations, the bag contains the following:

- A black ball.
- $k$ non-black balls of exactly one color (say color 1).

The probability that there is still only one non-black color after $k+1$ operations is calculated as follows:

- In the $(k+1)$-th operation, there are $k+1$ balls in the bag: 1 black ball and $k$ non-black balls of the same color.
- The probability of drawing the black ball (B) is $\frac{1}{k+1}$.
  - If the black ball is drawn, a new color is introduced, so we would no longer have exactly one non-black color.
- The probability of drawing one of the $k$ non-black balls (all of color 1) is $\frac{k}{k+1}$.
  - If a non-black ball is drawn, it is put back with another ball of the same color, and we still have only one non-black color.

Thus, the probability that after $k+1$ operations there is still only one non-black color in the bag is:

$$

\text{Probability} = \text{(Probability there was 1 color after $k$ operations)} \times \text{(Probability that $k+1$ operation keeps 1 color)}

$$

Using the inductive hypothesis:

$$

\text{Probability} = \frac{1}{k} \times \frac{k}{k+1} = \frac{1}{k+1}

$$

This completes the inductive step.

#### Conclusion

Since we have shown that the hypothesis holds for $n=1$, and that if it holds for $n=k$, it also holds for $n=k+1$, by the principle of mathematical induction, the probability that there is exactly 1 non-black color in the bag after $n$ operations is $\frac{1}{n}$.

### Question 4

To derive the probability $q_n(m)$ that after $n$ operations the number of non-black colors in the bag is exactly $m$, we can approach this problem purely from a combinatorial perspective.

#### Step 1: Understanding the Setup

1. **Initial Condition**: The bag starts with 1 black ball.
2. **Operation Process**:
   - If a black ball is drawn, a new color is introduced into the bag.
   - If a non-black ball is drawn, a ball of the same color is added to the bag.

#### Step 2: Counting the Configurations

To determine $q_n(m)$, we need to count the number of different ways to end up with exactly $m$ distinct non-black colors after $n$ operations and then divide this by the total number of possible outcomes.

1. **Total Number of Outcomes**: After $n$ operations, the total number of possible outcomes is $n!$ because each operation can occur in any sequence.

2. **Favorable Configurations**: We must count the number of ways to partition the sequence of $n$ operations such that exactly $m$ distinct non-black colors are introduced.

#### Step 3: Recursive Counting of Configurations

Consider the situation where we have performed $n-1$ operations and are performing the $n$-th operation.

- **Case 1**: The $n$-th operation introduces a new color (this occurs when a black ball is drawn).
  - For this to happen, there must have been exactly $m-1$ distinct colors after $n-1$ operations.
  - There is exactly 1 way to introduce a new color in the $n$-th operation.
  - The number of favorable configurations for this scenario is the number of ways to end up with $m-1$ colors after $n-1$ operations.

- **Case 2**: The $n$-th operation does not introduce a new color (this occurs when a non-black ball is drawn).
  - For this to happen, there must have been exactly $m$ distinct colors after $n-1$ operations.
  - There are $n-1$ ways to perform this operation since it can involve any of the $n-1$ existing balls (which already represent the $m$ colors).
  - The number of favorable configurations for this scenario is the number of ways to have $m$ colors after $n-1$ operations, multiplied by $n-1$ (because any of the previous operations could have been the one that added the ball of an existing color).

The recurrence relation for the number of favorable configurations $C(n, m)$ is therefore:

$$

C(n, m) = C(n-1, m-1) + (n-1)C(n-1, m)

$$

#### Step 4: Initial Conditions

We define the initial conditions as follows:

- $C(1, 1) = 1$: There is exactly one way to introduce one color after the first operation.
- $C(n, m) = 0$ if $m > n$: You cannot have more colors than operations.
- $C(n, m) = 0$ if $m = 0$ and $n > 0$: You must have at least one color after any positive number of operations.

#### Step 5: Calculating the Probability

Now, we can calculate the probability $q_n(m)$ by dividing the number of favorable configurations $S(n, m)$ by the total number of outcomes $n!$:

$$

q_n(m) = \frac{S(n, m)}{n!}

$$

Where $S(n, m)$ is computed using the recursive formula:

$$

S(n, m) = S(n-1, m-1) + (n-1)S(n-1, m)

$$

This recursive relation allows us to calculate the exact number of configurations that result in exactly $m$ non-black colors after $n$ operations.

### Question 5: Find the Minimum Number of Trials for Probability Exceeding 35% for at Least 3 Colors

We are tasked with finding the smallest number of trials $n$ such that the probability of having at least 3 non-black colors in the bag exceeds 35%.

#### Step 1: Understand the Probability Condition

The goal is to find the smallest $n$ such that:

$$

P(\text{at least 3 colors after } n \text{ operations}) > 0.35

$$

This can be expressed as:

$$

q_n(3) + q_n(4) + \cdots + q_n(n) > 0.35

$$

However, since the total probability sums to 1, we can equivalently solve:

$$

q_n(0) + q_n(1) + q_n(2) < 0.65

$$

Where:

- $q_n(0)$ is the probability of having 0 non-black colors (impossible for $n \geq 1$).
- $q_n(1)$ is the probability of having exactly 1 non-black color.
- $q_n(2)$ is the probability of having exactly 2 non-black colors.

#### Step 2: Calculate $q_n(0)$, $q_n(1)$, and $q_n(2)$ Recursively

The probability $q_n(m)$ is computed using the combinatorial approach discussed earlier:

$$

q_n(m) = \frac{S(n, m)}{n!}

$$

Where $C(n, m)$ is the number of favorable configurations, and it satisfies the recurrence relation:

$$

S(n, m) = S(n-1, m-1) + (n-1)S(n-1, m)

$$

With the initial conditions:

- $S(1, 1) = 1$ and $S(1, m) = 0$ for $m > 1$.
- $S(n, 0) = 0$ for all $n \geq 1$.

#### Step 3: Determine the Minimum $n$

We need to find the smallest $n$ such that:

$$

q_n(0) + q_n(1) + q_n(2) < 0.65

$$

#### Step 4: Calculating $n$

We need to find the smallest $n$ such that:

$$

q_n(3) + q_n(4) + \cdots + q_n(n) > 0.35

$$

Given the total probability must sum to 1, we can equivalently calculate:

$$

q_n(0) + q_n(1) + q_n(2) < 0.65

$$

This means we need to compute the probabilities $q_n(0)$, $q_n(1)$, and $q_n(2)$ for increasing values of $n$ until their sum is less than 0.65. Let's examine the results:

1. **For $n = 3$**:
   - The sum $q_3(0) + q_3(1) + q_3(2)$ is approximately 0.833.
   - This is greater than 0.65, so the probability of having at least 3 colors is less than 0.35.

2. **For $n = 4$**:
   - The sum $q_4(0) + q_4(1) + q_4(2)$ is approximately 0.708.
   - This is still greater than 0.65, so the probability of having at least 3 colors is still less than 0.35.
   - However, $q_4(3) + q_4(4)$ (the probability of having at least 3 colors) is approximately 0.292, which is less than 0.35.

3. **For $n = 5$**:
   - The sum $q_4(0) + q_4(1) + q_4(2)$ is approximately 0.617.

Since this probability exceeds 0.35, $n = 5$ is indeed the smallest value that satisfies the condition.

### Question 6: Proof Using Mathematical Induction and the Recurrence Relation

We want to prove the following equality for all natural numbers $n$:

$$

\sum_{m=1}^{n} m \cdot q_n(m) = 1 + \frac{1}{2} + \cdots + \frac{1}{n}

$$

where $q_n(m)$ satisfies the recurrence relation derived from the problem:

$$

q_n(m) = \frac{1}{n} q_{n-1}(m-1) + \frac{n-1}{n} q_{n-1}(m)

$$

#### Step 1: Base Case $n = 1$

For $n = 1$:

- $q_1(1) = 1$ since after the first operation, there is exactly one non-black color.
- There are no other possible outcomes, so $q_1(m) = 0$ for all $m > 1$.

Thus:

$$

\sum_{m=1}^{1} m \cdot q_1(m) = 1 \cdot q_1(1) = 1

$$

And the right-hand side is also:

$$

1 = 1

$$

The base case holds true.

#### Step 2: Inductive Hypothesis

Assume that the statement holds for some $n = k$:

$$

\sum_{m=1}^{k} m \cdot q_k(m) = 1 + \frac{1}{2} + \cdots + \frac{1}{k}

$$

We need to prove that the statement holds for $n = k + 1$:

$$

\sum_{m=1}^{k+1} m \cdot q_{k+1}(m) = 1 + \frac{1}{2} + \cdots + \frac{1}{k+1}

$$

#### Step 3: Prove for $n = k + 1$

Using the recurrence relation for $q_{k+1}(m)$:

$$

q_{k+1}(m) = \frac{1}{k+1} q_k(m-1) + \frac{k}{k+1} q_k(m)

$$

Now, compute the sum:

$$

\sum_{m=1}^{k+1} m \cdot q_{k+1}(m) = \sum_{m=1}^{k+1} m \left( \frac{1}{k+1} q_k(m-1) + \frac{k}{k+1} q_k(m) \right)

$$

Distribute the sum:

$$

\sum_{m=1}^{k+1} m \cdot q_{k+1}(m) = \frac{1}{k+1} \sum_{m=1}^{k+1} m \cdot q_k(m-1) + \frac{k}{k+1} \sum_{m=1}^{k+1} m \cdot q_k(m)

$$

#### Step 4: Simplify the Sum

Let’s analyze each term separately:

1. **First Term** $\frac{1}{k+1} \sum_{m=1}^{k+1} m \cdot q_k(m-1)$:

   Notice that $q_k(m-1)$ shifts the index by 1. This can be rewritten as:

   $$

   \frac{1}{k+1} \sum_{m=1}^{k+1} m \cdot q_k(m-1) = \frac{1}{k+1} \sum_{m=0}^{k} (m+1) \cdot q_k(m)

   $$

   Simplifying this:

   $$

   = \frac{1}{k+1} \left( \sum_{m=1}^{k} m \cdot q_k(m) + \sum_{m=0}^{k} q_k(m) \right)

   $$

   Since $\sum_{m=0}^{k} q_k(m) = 1$ (the total probability), this becomes:

   $$

   = \frac{1}{k+1} \left( \sum_{m=1}^{k} m \cdot q_k(m) + 1 \right)

   $$

2. **Second Term** $\frac{k}{k+1} \sum_{m=1}^{k+1} m \cdot q_k(m)$:

   This term simplifies directly as:

   $$

   \frac{k}{k+1} \sum_{m=1}^{k+1} m \cdot q_k(m) = \frac{k}{k+1} \sum_{m=1}^{k} m \cdot q_k(m) + (k+1) \cdot q_k(k+1) = \frac{k}{k+1} \sum_{m=1}^{k} m \cdot q_k(m)

   $$

   Since $q_k(k+1) = 0$.

#### Step 5: Combine the Results

Combining the two terms:

$$

\sum_{m=1}^{k+1} m \cdot q_{k+1}(m) = \frac{1}{k+1} \left( \sum_{m=1}^{k} m \cdot q_k(m) + 1 \right) + \frac{k}{k+1} \sum_{m=1}^{k} m \cdot q_k(m)

$$

Factor out the common sum $\sum_{m=1}^{k} m \cdot q_k(m)$:

$$

= \sum_{m=1}^{k} m \cdot q_k(m) \cdot \frac{1}{k+1} + \frac{k}{k+1} + \frac{1}{k+1}

$$

Simplify:

$$

= \sum_{m=1}^{k} m \cdot q_k(m) + \frac{1}{k+1}

$$

By the inductive hypothesis:

$$

\sum_{m=1}^{k} m \cdot q_k(m) = 1 + \frac{1}{2} + \cdots + \frac{1}{k}

$$

Thus:

$$

\sum_{m=1}^{k+1} m \cdot q_{k+1}(m) = 1 + \frac{1}{2} + \cdots + \frac{1}{k} + \frac{1}{k+1}

$$

This completes the inductive step, proving that:

$$

\sum_{m=1}^{n} m \cdot q_n(m) = 1 + \frac{1}{2} + \cdots + \frac{1}{n}

$$

## 知识点

#组合计数 #递推公式 #概率论 #Stirling数 #数学归纳法

## 难点思路

这道题目中最具挑战性的部分是第 4 问和第 6 问。第 4 问需要认识到问题与 Stirling 数的关系,这需要对组合数学有较深入的了解。第 6 问的证明需要巧妙地运用数学归纳法和概率的性质。

## 解题技巧和信息

1. 对于小规模的问题,穷举所有可能性是一个好方法。
2. 寻找递归关系可以帮助解决大规模的问题。
3. 熟悉常见的组合数学工具 (如 Stirling 数) 对解决此类问题很有帮助。
4. 在处理概率问题时,注意概率的加法规则和条件概率。
5. 数学归纳法是证明涉及自然数的命题的强大工具。

## 重点词汇

- probability 概率
- conditional probability 条件概率
- recursion relation 递归关系
- Stirling numbers of the second kind 第二类 Stirling 数
- mathematical induction 数学归纳法
- enumeration 枚举

## 参考资料

1. Feller, W. (1968). An Introduction to Probability Theory and Its Applications, Vol. 1, 3rd Edition. Wiley. Chapter 2: Sample Spaces.
2. Graham, R. L., Knuth, D. E., & Patashnik, O. (1994). Concrete Mathematics: A Foundation for Computer Science. Addison-Wesley. Chapter 6: Special Numbers.
