# IS Math-2016-03

**题目来源**：[[做题/文字版题库/IS_Math/2016#Problem 3]]
**日期**：2024-08-12
**题目主题**：Math-Discrete Mathematics-Combinatorics

## 解题思路

这道题目涉及排列组合中的分配问题以及颜色球排列中的“run”的概念。我们将首先计算将 $n$ 个相同的球分配到 $r$ 个不同的箱子中的方法数。接着，分析黑球和白球的排列并计算相关的概率和期望值。

## Solution

### Question 1: Calculate the number of possible ways to distribute $n$ equivalent balls to $r$ distinguishable boxes such that each box contains at least one ball, where $n \geq 1$ and $1 \leq r \leq n$

To solve this problem, we need to find the number of non-negative integer solutions to the equation:

$$
x_1 + x_2 + \dots + x_r = n
$$

where each $x_i \geq 1$. We can transform this into a problem with non-negative integers by setting $y_i = x_i - 1$ for each $i$. Then the equation becomes:

$$
(y_1 + 1) + (y_2 + 1) + \dots + (y_r + 1) = n,
$$

which simplifies to:

$$
y_1 + y_2 + \dots + y_r = n - r.
$$

The number of non-negative integer solutions to this equation is given by the binomial coefficient:

$$
\binom{n-1}{r-1}.
$$

### Question 2: Calculate the total number of arrangements when we do not distinguish among balls of the same color

The total number of arrangements of $n$ black balls and $m$ white balls is the number of ways to arrange $n + m$ objects, where $n$ objects are of one type and $m$ are of another type. This is given by:

$$
\binom{n+m}{n}.
$$

### Question 3: Calculate the probability $P(r, s)$ that the number of runs of black balls is $r$ and the number of runs of white balls is $s$

To calculate $P(r, s)$, we need to consider the constraints on $r$ and $s$. Specifically:

1. The difference $|r - s|$ cannot be greater than 1 because it is impossible to have a situation where the difference between the number of runs of black balls and white balls is 2 or more.
2. If $r = s$, there is a symmetric configuration where black and white runs can be swapped, effectively doubling the number of valid configurations.

Given these constraints, the probability $P(r, s)$ can be defined as follows:

- **If $|r - s| = 1$:**

The black balls are distributed into $r$ segments, and the white balls into $s$ segments. The number of ways to achieve this distribution is:

$$
P(r, s) = \frac{\binom{n-1}{r-1} \binom{m-1}{s-1}}{\binom{n+m}{n}}.
$$

- **If $r = s$:**

The probability needs to account for the symmetric nature of the configuration, so:

$$
P(r, r) = 2 \cdot \frac{\binom{n-1}{r-1} \binom{m-1}{r-1}}{\binom{n+m}{n}}.
$$

- **If $|r - s| \geq 2$:**

It is impossible to have such a configuration, so:

$$
P(r, s) = 0.
$$

In summary, to calculate $P(r, s)$:

$$
P(r, s) =
\begin{cases}
0 & \text{if } |r - s| \geq 2, \\
\frac{\binom{n-1}{r-1} \binom{m-1}{s-1}}{\binom{n+m}{n}} & \text{if } |r - s| = 1, \\
2 \cdot \frac{\binom{n-1}{r-1} \binom{m-1}{r-1}}{\binom{n+m}{n}} & \text{if } r = s.
\end{cases}
$$

This solution correctly accounts for the various cases where $r$ and $s$ are equal, differ by 1, or differ by 2 or more.

### Question 4: Calculate the probability $P(r)$ that the number of runs of black balls is $r$

To calculate the probability $P(r)$, we need to sum the probabilities $P(r, s)$ over all possible values of $s$, where $1 \leq s \leq m$. Using the updated expression for $P(r, s)$:

$$
P(r) = \sum_{s=1}^m P(r, s).
$$

Recall the expression for $P(r, s)$:

$$
P(r, s) =
\begin{cases}
\frac{\binom{n-1}{r-1} \binom{m-1}{s-1}}{\binom{n+m}{n}} & \text{if } |r - s| = 1, \\
2 \cdot \frac{\binom{n-1}{r-1} \binom{m-1}{r-1}}{\binom{n+m}{n}} & \text{if } r = s, \\
0 & \text{if } |r - s| \geq 2.
\end{cases}
$$

To calculate $P(r)$, we sum this expression over all $s$. Note that the only non-zero contributions come from $s = r-1$, $s = r$, and $s = r+1$:

$$
P(r) = \frac{\binom{n-1}{r-1} \binom{m-1}{r-2}}{\binom{n+m}{n}} + 2 \cdot \frac{\binom{n-1}{r-1} \binom{m-1}{r-1}}{\binom{n+m}{n}} + \frac{\binom{n-1}{r-1} \binom{m-1}{r}}{\binom{n+m}{n}}.
$$

We can factor out the common term $\frac{\binom{n-1}{r-1}}{\binom{n+m}{n}}$:

$$
P(r) = \frac{\binom{n-1}{r-1}}{\binom{n+m}{n}} \left[\binom{m-1}{r-2} + 2 \binom{m-1}{r-1} + \binom{m-1}{r} \right].
$$

The expression inside the brackets is a sum of three consecutive binomial coefficients, which simplifies to:

$$
P(r) = \frac{\binom{n-1}{r-1}}{\binom{n+m}{n}} \binom{m+1}{r}.
$$

Thus, the probability that the number of runs of black balls is $r$ is given by:

$$
P(r) = \frac{\binom{n-1}{r-1} \binom{m+1}{r}}{\binom{n+m}{n}}.
$$

### Question 5: Using $(1 + x)^n(1 + x)^m = (1 + x)^{n+m}$, show that the following equations hold

We start with the binomial expansions of $(1 + x)^n$ and $(1 + x)^m$:

$$
(1 + x)^n = \sum_{i=0}^n \binom{n}{i} x^i,
$$

$$
(1 + x)^m = \sum_{j=0}^m \binom{m}{j} x^j.
$$

Multiplying these expansions together:

$$
(1 + x)^n(1 + x)^m = \left(\sum_{i=0}^n \binom{n}{i} x^i\right)\left(\sum_{j=0}^m \binom{m}{j} x^j\right).
$$

Expanding the product:

$$
(1 + x)^n(1 + x)^m = \sum_{i=0}^n \sum_{j=0}^m \binom{n}{i} \binom{m}{j} x^{i+j}.
$$

We can group the terms based on the powers of $x$. For a specific power $k = i + j$, the coefficient of $x^k$ is:

$$
\sum_{\substack{i+j = k \\ 0 \leq i \leq n \\ 0 \leq j \leq m}} \binom{n}{i} \binom{m}{j}.
$$

Since $k$ can range from 0 to $n+m$, the full expansion of $(1 + x)^{n+m}$ gives:

$$
(1 + x)^{n+m} = \sum_{k=0}^{n+m} \binom{n+m}{k} x^k.
$$

The coefficients of $x^k$ on both sides must be equal. Therefore, for a particular $k$, we have:

$$
\sum_{\substack{i+j = k \\ 0 \leq i \leq n \\ 0 \leq j \leq m}} \binom{n}{i} \binom{m}{j} = \binom{n+m}{k}.
$$

Now, let’s consider the specific cases of interest.

#### Derivation of Equation (3.1)

$$
\sum_{\ell=0}^{\min\{n,m\}} \binom{n}{\ell} \binom{m}{\ell} = \binom{n+m}{m}.
$$

To derive this, consider the case where $k = m$. We want to collect the terms where $i = \ell$ and $j = m - \ell$, ensuring that $\ell$ does not exceed the smaller of $n$ and $m$. Thus, we sum over $\ell$ from 0 to $\min\{n, m\}$:

$$
\sum_{\ell=0}^{\min\{n,m\}} \binom{n}{\ell} \binom{m}{\ell}.
$$

This is the sum of coefficients where $i = \ell$ and $j = \ell$ in the expansion of $(1 + x)^n(1 + x)^m$. Comparing this with the binomial expansion of $(1 + x)^{n+m}$, we see that the coefficient of $x^m$ is $\binom{n+m}{m}$. Therefore:

$$
\sum_{\ell=0}^{\min\{n,m\}} \binom{n}{\ell} \binom{m}{\ell} = \binom{n+m}{m}.
$$

#### Derivation of Equation (3.2)

$$
\sum_{\ell=0}^{\min\{n-1,m\}} \binom{n}{\ell+1} \binom{m}{\ell} = \binom{n+m}{m+1}.
$$

To derive this, consider the case where $k = m + 1$. We now want to collect the terms where $i = \ell + 1$ and $j = \ell$. Again, $\ell$ ranges from 0 to $\min\{n-1, m\}$, since $i$ must be at least 1 for $\ell + 1$ to make sense:

$$
\sum_{\ell=0}^{\min\{n-1,m\}} \binom{n}{\ell+1} \binom{m}{\ell}.
$$

This corresponds to the sum of coefficients in the expansion of $(1 + x)^n(1 + x)^m$ that yield the term $x^{m+1}$. According to the binomial expansion of $(1 + x)^{n+m}$, the coefficient of $x^{m+1}$ is $\binom{n+m}{m+1}$. Therefore:

$$
\sum_{\ell=0}^{\min\{n-1,m\}} \binom{n}{\ell+1} \binom{m}{\ell} = \binom{n+m}{m+1}.
$$

### Question 6: Calculation of the Expected Value $E(r)$ and the Variance $V(r)$ of $r$

We start with the probability distribution $P(r)$:

$$
P(r) = \frac{\binom{n-1}{r-1} \binom{m+1}{r}}{\binom{n+m}{n}}.
$$

#### Expected Value $E(r)$

The expected value $E(r)$ is given by:

$$
E(r) = \sum_{r=1}^{n} r \cdot P(r).
$$

Substitute $P(r)$:

$$
E(r) = \sum_{r=1}^{n} r \cdot \frac{\binom{n-1}{r-1} \binom{m+1}{r}}{\binom{n+m}{n}}.
$$

Factor out the constant $\frac{1}{\binom{n+m}{n}}$:

$$
E(r) = \frac{1}{\binom{n+m}{n}} \sum_{r=1}^{n} r \binom{n-1}{r-1} \binom{m+1}{r}.
$$

Notice that $r \binom{m+1}{r}$ can be rewritten using the identity $r \binom{m+1}{r} = (m+1) \binom{m}{r-1}$:

$$
E(r) = \frac{1}{\binom{n+m}{n}} \sum_{r=1}^{n} \binom{n-1}{r-1} \cdot (m+1) \binom{m}{r-1}.
$$

Shift the index of summation by setting $k = r-1$:

$$
E(r) = \frac{m+1}{\binom{n+m}{n}} \sum_{k=0}^{n-1} \binom{n-1}{k} \binom{m}{k}.
$$

Using the identity from Question 5, specifically the result:

$$
\sum_{k=0}^{\min\{n-1,m\}} \binom{n-1}{k} \binom{m}{k} = \binom{n+m-1}{m},
$$

we have:

$$
E(r) = \frac{m+1}{\binom{n+m}{n}} \cdot \binom{n+m-1}{m}.
$$

Using the identity $\binom{n+m}{n} = \frac{n+m}{m} \binom{n+m-1}{m}$, we simplify:

$$
E(r) = \frac{m+1}{n+m} \cdot (m+n) = \frac{n(m+1)}{n+m}.
$$

#### Variance $V(r)$

The variance $V(r)$ is given by:

$$
V(r) = E(r^2) - (E(r))^2.
$$

##### Step 1: Calculate $E(r)$

From the previous derivation:

$$

E(r) = \frac{n(m+1)}{n+m}

$$

##### Step 2: Calculate $E(r^2)$

To find $E(r^2)$, we need to compute:

$$

E(r^2) = \sum_{r=1}^{n} r^2 \cdot P(r)

$$

Substitute $P(r)$:

$$

E(r^2) = \frac{1}{\binom{n+m}{n}} \sum_{r=1}^{n} r^2 \binom{n-1}{r-1} \binom{m+1}{r}

$$

As previously discussed, we can use the identity $r \binom{m+1}{r} = (m+1) \binom{m}{r-1}$. For $r^2$, we rewrite it as:

$$

r \binom{m+1}{r} = (m+1) \binom{m}{r-1}

$$

Substitute and simplify:

$$

E(r^2) = \frac{1}{\binom{n+m}{n}} \sum_{r=1}^{n} \left[(r-1) (m+1) \binom{n-1}{r-1} \binom{m}{r-1} + (m+1) \binom{n-1}{r-1} \binom{m}{r-1}\right]

$$

Since $E(r) = \frac{m+1}{\binom{n+m}{n}} \sum_{k=0}^{n-1} \binom{n-1}{k} \binom{m}{k}$,

$$
E(r^2) = E(r) + \frac{m+1}{\binom{n+m}{n}} \sum_{r=1}^{n} (r-1) \binom{n-1}{r-1} \binom{m}{r-1} = E(r) + \frac{(m+1)(n-1)}{\binom{n+m}{n}} \sum_{r=1}^{n} \binom{n-2}{r-2} \binom{m}{r-1} 
$$

Using the identity from Question 5, specifically the result:

$$
\sum_{k=0}^{\min\{n-1,m\}} \binom{n-1}{k} \binom{m}{k+1} = \binom{n+m-1}{m},
$$

$$
E(r^2) = E(r) + \frac{(m+1)(n-1)}{\binom{n+m}{n}} \binom{m + n - 2}{n-1}
$$

$$

E(r^2) = E(r) + \frac{(m+1)(n-1)}{\binom{n+m}{n}} \binom{n + m - 2}{n-1}

$$

After simplifying:

$$

E(r^2) = \frac{n(n-1) \cdot m(m+1)}{(n+m)(n+m-1)} + E(r)

$$

##### Step 3: Calculate $V(r)$

Now, use the variance formula:

$$

V(r) = E(r^2) - (E(r))^2

$$

Substituting $E(r)$ and $E(r^2)$:

$$


V(r) = \frac{n(n-1) \cdot m(m+1)}{(n+m)(n+m-1)} + \frac{n(m+1)}{n+m} - \frac{n^2(m+1)^2}{(n+m)^2}


$$

Simplify the expression:

$$

V(r) = \frac{n(m+1)}{(n+m)^2(n+m-1)} \left[(n-1)(n+m)m + n(m+1)(n+m)(n+m-1) - n(m+1)(n+m-1)\right]

$$

Further simplification gives:

$$

V(r) = \frac{n(n-1) \cdot m(m+1)}{(n+m)^2(n+m-1)}

$$

#### Conclusion

The variance $V(r)$ is:

$$

V(r) = \frac{n(n-1) \cdot m(m+1)}{(n+m)^2(n+m-1)}

$$

This expression describes how the number of runs fluctuates around the expected value, depending on the ratio of black to white balls.

#### Limits as $N \to \infty$

Now, consider the limits:

$$
\lim_{N \to \infty} \frac{E(r)}{N} = \lim_{N \to \infty} \frac{\frac{n(m+1)}{n+m}}{n+m} = \lim_{N \to \infty} \frac{n(m+1)}{(n+m)(n+m)} = \lim_{N \to \infty} \lambda(1-\lambda + \frac{1}{N}) = \lim_{N \to \infty}\lambda(1-\lambda),
$$

where $\lambda = \lim_{N \to \infty} \frac{n}{N}$ is constant.

Similarly:

$$
\lim_{N \to \infty} \frac{V(r)}{N} = \lim_{N \to \infty} \frac{\frac{n(n-1) \cdot m(m+1)}{(n+m)^2(n+m-1)}}{N} = \lim_{N \to \infty} \frac{\lambda(\lambda-\frac{1}{N}) \cdot (1-\lambda)(1-\lambda+\frac{1}{N})}{N^3(N-1)} = \lim_{N \to \infty} \lambda^2(1-\lambda)^2
$$

## 知识点

#组合数学 #排列组合 #概率论 #期望 #方差 #二项式定理 #生成函数

## 难点思路

1. 计算黑球和白球的 runs 的概率分布 $P(r,s)$ 时,需要考虑 $r$ 和 $s$ 之间的关系,特别是当 $r=s$ 时的对称情况。

2. 使用生成函数证明组合恒等式时,需要巧妙地运用二项式展开和系数比较。

3. 计算期望 $E(r)$ 和方差 $V(r)$ 时,需要灵活运用组合恒等式和概率分布的性质。

## 解题技巧和信息

1. 球的分配问题可以转化为求非负整数解的方程,再通过变量替换简化为求组合数。

2. 计算概率时,注意考虑所有可能的情况,尤其是特殊情况 (如 $r=s$ )。

3. 使用生成函数证明组合恒等式时,可以通过展开和比较系数来建立等式。

4. 计算期望和方差时,可以先计算 $E(r)$ 和 $E(r^2)$ ,然后利用 $V(r) = E(r^2) - (E(r))^2$ 。

5. 对于复杂的组合表达式,尝试使用已知的组合恒等式进行化简。

6. 在计算概率分布的极限行为时,注意保持比例关系 (如 n/N = λ)。

## 重点词汇

1. Combinatorics - 组合数学
2. Probability - 概率
3. Expectation - 期望
4. Variance - 方差
5. Binomial coefficient - 二项式系数
6. Generating function - 生成函数
7. Distribution - 分布
8. Run - 连续段
9. Limit - 极限

## 参考资料

1. Concrete Mathematics: A Foundation for Computer Science, by Ronald L. Graham, Donald E. Knuth, and Oren Patashnik, Chapter 5 (Binomial Coefficients) and Chapter 7 (Generating Functions)

2. An Introduction to Probability Theory and Its Applications, by William Feller, Volume I, Chapter III (Combinations and Permutations) and Chapter IX (Generating Functions)

3. Enumerative Combinatorics, by Richard P. Stanley, Volume 1, Chapter 1 (What is Enumerative Combinatorics?) and Chapter 2 (Sieve Methods)

4. Probabilistic Combinatorics and Its Applications, edited by Béla Bollobás, Chapter 1 (The Probabilistic Method) and Chapter 3 (Random Graphs)
